<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>商品分类 | 小兔鲜儿</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="小兔鲜儿PC前台-开发文档">
    
    <link rel="preload" href="/erabbit-client-pc-document/assets/css/0.styles.bfb7a5cd.css" as="style"><link rel="preload" href="/erabbit-client-pc-document/assets/js/app.948bdee4.js" as="script"><link rel="preload" href="/erabbit-client-pc-document/assets/js/2.e30d490f.js" as="script"><link rel="preload" href="/erabbit-client-pc-document/assets/js/14.e446ef51.js" as="script"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/10.967a337a.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/11.695b6fd5.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/12.ef3d904c.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/13.203ca22a.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/15.240da5b5.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/16.a42caf07.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/17.ff63a27b.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/18.261777ab.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/3.2ebc11dd.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/4.0f8dcd9c.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/5.e91a9095.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/6.8b45773c.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/7.cc81a86f.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/8.0ee24dd1.js"><link rel="prefetch" href="/erabbit-client-pc-document/assets/js/9.5c3ae8a2.js">
    <link rel="stylesheet" href="/erabbit-client-pc-document/assets/css/0.styles.bfb7a5cd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/erabbit-client-pc-document/" class="home-link router-link-active"><img src="/erabbit-client-pc-document/hero.png" alt="小兔鲜儿" class="logo"> <span class="site-name can-hide">小兔鲜儿</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/erabbit-client-pc-document/guide/00-vue3pre.html" class="nav-link">
  vue3前置
</a></div><div class="nav-item"><a href="/erabbit-client-pc-document/guide/01-intro.html" class="nav-link">
  项目介绍
</a></div><div class="nav-item"><a href="/erabbit-client-pc-document/guide/02-started.html" class="nav-link">
  项目起步
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="功能模块" class="dropdown-title"><span class="title">功能模块</span> <span class="arrow down"></span></button> <button type="button" aria-label="功能模块" class="mobile-dropdown-title"><span class="title">功能模块</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/03-home.html" class="nav-link">
  首页模块
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/04-category.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  分类模块
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/05-detail.html" class="nav-link">
  商品详情
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/06-login.html" class="nav-link">
  登录模块
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/07-cart.html" class="nav-link">
  购物车
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/08-pay.html" class="nav-link">
  结算&amp;支付
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/09-member.html" class="nav-link">
  个人中心
</a></li></ul></div></div><div class="nav-item"><a href="/erabbit-client-pc-document/guide/10-end.html" class="nav-link">
  项目总结
</a></div> <a href="http://git.itcast.cn/zhousg/erabbit-client-pc-vue3" target="_blank" rel="noopener noreferrer" class="repo-link">
    Gitlab
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/erabbit-client-pc-document/guide/00-vue3pre.html" class="nav-link">
  vue3前置
</a></div><div class="nav-item"><a href="/erabbit-client-pc-document/guide/01-intro.html" class="nav-link">
  项目介绍
</a></div><div class="nav-item"><a href="/erabbit-client-pc-document/guide/02-started.html" class="nav-link">
  项目起步
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="功能模块" class="dropdown-title"><span class="title">功能模块</span> <span class="arrow down"></span></button> <button type="button" aria-label="功能模块" class="mobile-dropdown-title"><span class="title">功能模块</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/03-home.html" class="nav-link">
  首页模块
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/04-category.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  分类模块
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/05-detail.html" class="nav-link">
  商品详情
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/06-login.html" class="nav-link">
  登录模块
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/07-cart.html" class="nav-link">
  购物车
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/08-pay.html" class="nav-link">
  结算&amp;支付
</a></li><li class="dropdown-item"><!----> <a href="/erabbit-client-pc-document/guide/09-member.html" class="nav-link">
  个人中心
</a></li></ul></div></div><div class="nav-item"><a href="/erabbit-client-pc-document/guide/10-end.html" class="nav-link">
  项目总结
</a></div> <a href="http://git.itcast.cn/zhousg/erabbit-client-pc-vue3" target="_blank" rel="noopener noreferrer" class="repo-link">
    Gitlab
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>商品分类</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/erabbit-client-pc-document/guide/04-category.html#_01-顶级类目-面包屑组件-初级" class="sidebar-link">01-顶级类目-面包屑组件-初级</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_02-顶级类目-面包屑组件-高级" class="sidebar-link">02-顶级类目-面包屑组件-高级</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_03-顶级类目-批量注册组件" class="sidebar-link">03-顶级类目-批量注册组件</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_04-顶级类目-基础布局搭建" class="sidebar-link">04-顶级类目-基础布局搭建</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_05-顶级类目-分类商品-布局" class="sidebar-link">05-顶级类目-分类商品-布局</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_06-顶级类目-分类商品-展示" class="sidebar-link">06-顶级类目-分类商品-展示</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_07-顶级类目-面包屑切换动画" class="sidebar-link">07-顶级类目-面包屑切换动画</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_08-二级类目-处理跳转细节" class="sidebar-link">08-二级类目-处理跳转细节</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_09-二级类目-展示面包屑" class="sidebar-link">09-二级类目-展示面包屑</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_10-二级类目-筛选区展示" class="sidebar-link">10-二级类目-筛选区展示</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_11-二级类目-复选框组件封装" class="sidebar-link">11-二级类目-复选框组件封装</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_12-二级类目-结果区-排序组件" class="sidebar-link">12-二级类目-结果区-排序组件</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_13-二级类目-结果区-数据加载" class="sidebar-link">13-二级类目-结果区-数据加载</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/erabbit-client-pc-document/guide/04-category.html#_14-二级类目-结果区-进行筛选" class="sidebar-link">14-二级类目-结果区-进行筛选</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="商品分类"><a href="#商品分类" class="header-anchor">#</a> 商品分类</h1> <h2 id="_01-顶级类目-面包屑组件-初级"><a href="#_01-顶级类目-面包屑组件-初级" class="header-anchor">#</a> 01-顶级类目-面包屑组件-初级</h2> <blockquote><p><strong>目的：</strong>  封装一个简易的面包屑组件，适用于两级场景。</p></blockquote> <p><strong>大致步骤：</strong></p> <ul><li>准备静态的 <code>xtx-bread.vue</code> 组件</li> <li>定义 <code>props</code> 暴露 <code>parentPath</code> <code>parentName</code>  属性，默认插槽，动态渲染组件</li> <li>在 <code>library/index.js</code> 注册组件，使用验证效果。</li></ul> <p><strong>落的代码：</strong></p> <ul><li>基础结构 <code>src/components/library/xtx-bread.vue</code></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>xtx-bread<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xtx-bread-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RouterLink</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RouterLink</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iconfont icon-angle-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xtx-bread-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RouterLink</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/category/10000<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>电器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RouterLink</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iconfont icon-angle-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xtx-bread-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>空调<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'XtxBread'</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.xtx-bread</span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 25px 10px<span class="token selector">;
  &amp;-item</span> <span class="token punctuation">{</span>
    <span class="token selector">a</span> <span class="token punctuation">{</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
      <span class="token property">transition</span><span class="token punctuation">:</span> all .4s<span class="token selector">;
      &amp;:hover</span> <span class="token punctuation">{</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">i</span> <span class="token punctuation">{</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">margin-right</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 22px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>定义props进行渲染  <code>src/components/library/xtx-bread.vue</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class='xtx-bread'&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;xtx-bread-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;RouterLink to=&quot;/&quot;&gt;首页&lt;/RouterLink&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;i class=&quot;iconfont icon-angle-right&quot;&gt;&lt;/i&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;div class=&quot;xtx-bread-item&quot; v-if=&quot;parentName&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;RouterLink v-if=&quot;parentPath&quot; :to=&quot;parentPath&quot;&gt;{{parentName}}&lt;/RouterLink&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;span v-else&gt;{{parentName}}&lt;/span&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;i v-if=&quot;parentName&quot; class=&quot;iconfont icon-angle-right&quot;&gt;&lt;/i&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;xtx-bread-item&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;span&gt;&lt;slot /&gt;&lt;/span&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'XtxBread',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  props: {
</span><span class="token prefix inserted">+</span><span class="token line">    parentName: {
</span><span class="token prefix inserted">+</span><span class="token line">      type: String,
</span><span class="token prefix inserted">+</span><span class="token line">      default: ''
</span><span class="token prefix inserted">+</span><span class="token line">    },
</span><span class="token prefix inserted">+</span><span class="token line">    parentPath: {
</span><span class="token prefix inserted">+</span><span class="token line">      type: String,
</span><span class="token prefix inserted">+</span><span class="token line">      default: ''
</span><span class="token prefix inserted">+</span><span class="token line">    }
</span><span class="token prefix inserted">+</span><span class="token line">  }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><ul><li>注册使用  <code>src/components/library/index.js</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import 'XtxBread' from './xtx-bread.vue'
</span></span>
export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> install (app) {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      app.component(XtxBread.name, XtxBread)
</span></span></code></pre></div><p>使用： <code>&lt;XtxBread parentPath=&quot;/category/1005000&quot; parentName=&quot;电器&quot;&gt;空调&lt;/XtxBread&gt;</code></p> <p><strong>总结：</strong> 采用基本的封装手法，灵活度不是很高。</p> <h2 id="_02-顶级类目-面包屑组件-高级"><a href="#_02-顶级类目-面包屑组件-高级" class="header-anchor">#</a> 02-顶级类目-面包屑组件-高级</h2> <blockquote><p><strong>目的：</strong>  封装一个高复用的面包屑组件，适用于多级场景。认识 render 选项和 h 函数。</p></blockquote> <p>参考element-ui的面包屑组件：</p> <p><img src="/erabbit-client-pc-document/assets/img/1619946353625.3c33cbbe.png" alt="1619946353625"></p> <p><strong>大致步骤：</strong></p> <ul><li>使用插槽和封装选项组件完成面包屑组件基本功能，但是最后一项多一个图标。</li> <li>学习 render 选项，h 函数 的基本使用。</li> <li>通过 render 渲染，h 函数封装面包屑功能。</li></ul> <p><strong>落的代码：</strong></p> <ul><li>我们需要两个组件，<code>xtx-bread</code> 和  <code>xtx-bread-item</code> 才能完成动态展示。</li></ul> <p>定义单项面包屑组件 <code>src/components/library/xtx-bread-item.vue</code></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xtx-bread-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RouterLink</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>to<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>to<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RouterLink</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iconfont icon-angle-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'XtxBreadItem'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    to<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">,</span> Object<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p>在 <code>library/index.js</code>注册</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import 'XtxBreadItem' from './xtx-bread-item.vue'
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> install (app) {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      app.component(XtxBreadItem.name, XtxBread)
</span></span></code></pre></div><ul><li>过渡版，你发现结构缺少风格图标，如果在item中加上话都会有图标，但是最后一个是不需要的。</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>xtx-bread<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'XtxBread'</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 去掉scoped全局作用 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code>      <span class="token comment">&lt;!-- 面包屑 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/category/1005000<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>电器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token punctuation">&gt;</span></span>空调<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>终极版，使用render函数自己进行拼接创建。</li></ul> <p><a href="https://cn.vuejs.org/v2/guide/render-function.html#createElement-%E5%8F%82%E6%95%B0" target="_blank" rel="noopener noreferrer">createElement<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://cn.vuejs.org/v2/api/#render" target="_blank" rel="noopener noreferrer">render<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>render选项与h函数</code></p> <ul><li>指定组件显示的内容：<code>new Vue({选项})</code> <ul><li>el 选项，通过一个选择器找到容器，容器内容就是组件内容</li> <li>template 选项，<code>&lt;div&gt;组件内容&lt;/div&gt;</code> 作为组件内容</li> <li>render选项，它是一个函数，函数回默认传人createElement的函数（h），这个函数用来创建结构，再render函数返回渲染为组件内容。它的优先级更高。</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//import App from './App.vue'</span>
<span class="token comment">//new Vue({</span>
<span class="token comment">//    render:h=&gt;h(App)</span>
<span class="token comment">//}).mount('#app')</span>
<span class="token comment">// h() =====&gt;  createElement()</span>
<span class="token comment">// h(App) =====&gt;  根据APP组件创建html结构</span>
<span class="token comment">// render的返回值就是html结构，渲染到#app容器</span>
<span class="token comment">// h() 函数参数，1.节点名称  2. 属性|数据 是对象  3. 子节点</span>
</code></pre></div><p><code>xtx-bread-item.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;xtx-bread-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;RouterLink v-if=&quot;to&quot; :to=&quot;to&quot;&gt;&lt;slot /&gt;&lt;/RouterLink&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;span v-else&gt;&lt;slot /&gt;&lt;/span&gt;
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &lt;i class=&quot;iconfont icon-angle-right&quot;&gt;&lt;/i&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span></code></pre></div><p><code>xtx-bread.vue</code></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> h <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'XtxBread'</span><span class="token punctuation">,</span>
  <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用法</span>
    <span class="token comment">// 1. template 标签去除，单文件组件</span>
    <span class="token comment">// 2. 返回值就是组件内容</span>
    <span class="token comment">// 3. vue2.0 的h函数传参进来的，vue3.0 的h函数导入进来</span>
    <span class="token comment">// 4. h 第一个参数 标签名字  第二个参数 标签属性对象  第三个参数 子节点</span>
    <span class="token comment">// 需求</span>
    <span class="token comment">// 1. 创建xtx-bread父容器</span>
    <span class="token comment">// 2. 获取默认插槽内容</span>
    <span class="token comment">// 3. 去除xtx-bread-item组件的i标签，因该由render函数来组织</span>
    <span class="token comment">// 4. 遍历插槽中的item，得到一个动态创建的节点，最后一个item不加i标签</span>
    <span class="token comment">// 5. 把动态创建的节点渲染再xtx-bread标签中</span>
    <span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> dymanicItems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      dymanicItems<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token punctuation">(</span>items<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dymanicItems<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">class</span><span class="token operator">:</span> <span class="token string">'iconfont icon-angle-right'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">class</span><span class="token operator">:</span> <span class="token string">'xtx-bread'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> dymanicItems<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">// 去除 scoped 属性，目的：然样式作用到xtx-bread-item组件
.xtx-bread</span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 25px 10px<span class="token selector">;
  // ul li:last-child</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token selector">// 先找到父元素，找到所有的子元素，找到最后一个，判断是不是LI，是就是选中，不是就是无效选择器
  // ul li:last-of-type</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token selector">// 先找到父元素，找到所有的类型为li的元素，选中最后一个
  &amp;-item</span> <span class="token punctuation">{</span>
    <span class="token selector">a</span> <span class="token punctuation">{</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
      <span class="token property">transition</span><span class="token punctuation">:</span> all .4s<span class="token selector">;
      &amp;:hover</span> <span class="token punctuation">{</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">i</span> <span class="token punctuation">{</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">margin-right</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 22px<span class="token selector">;
    // 样式的方式，不合理
    // &amp;:last-child</span> <span class="token punctuation">{</span>
    //   <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    // <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>使用代码</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>      <span class="token comment">&lt;!-- 面包屑 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/category/1005000<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>电器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token punctuation">&gt;</span></span>空调<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>总结，一下知识点
<ul><li>render 是vue提供的一个渲染函数，优先级大于el,template等选项，用来提供组件结构。</li> <li>注意：
<ul><li>vue2.0  render函数提供h（createElement）函数用来创建节点</li> <li>vue3.0  h（createElement）函数有 vue 直接提供，需要按需导入</li></ul></li> <li>this.$slots.default() 获取默认插槽的node结构，按照要求拼接结构。</li> <li>h函数的传参 tag 标签名|组件名称, props 标签属性|组件属性, node 子节点|多个节点</li> <li>具体参考 <a href="/erabbit-client-pc-document/guide/[https:/vue-docs-next-zh-cn.netlify.app/guide/render-function.html#dom-树](https:/vue-docs-next-zh-cn.netlify.app/guide/render-function.html#dom-树)">render</a></li></ul></li> <li>注意：不要在 xtx-bread 组件插槽写注释，也会被解析。</li></ul> <h2 id="_03-顶级类目-批量注册组件"><a href="#_03-顶级类目-批量注册组件" class="header-anchor">#</a> 03-顶级类目-批量注册组件</h2> <blockquote><p><strong>目的：</strong>  自动的批量注册组件。</p></blockquote> <p>大致步骤：</p> <ul><li>使用 <code>require</code> 提供的函数 <code>context</code>  加载某一个目录下的所有 <code>.vue</code> 后缀的文件。</li> <li>然后 <code>context</code> 函数会返回一个导入函数 <code>importFn</code> <ul><li>它又一个属性 <code>keys()</code>  获取所有的文件路径</li></ul></li> <li>通过文件路径数组，通过遍历数组，再使用 <code>importFn</code>  根据路径导入组件对象</li> <li>遍历的同时进行全局注册即可</li></ul> <p>落的代码：</p> <p><code>src/components/library/index.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 其实就是vue插件，扩展vue功能，全局组件、指令、函数 （vue.30取消过滤器）</span>
<span class="token comment">// 当你在mian.js导入，使用Vue.use()  (vue3.0 app)的时候就会执行install函数</span>
<span class="token comment">// import XtxSkeleton from './xtx-skeleton.vue'</span>
<span class="token comment">// import XtxCarousel from './xtx-carousel.vue'</span>
<span class="token comment">// import XtxMore from './xtx-more.vue'</span>
<span class="token comment">// import XtxBread from './xtx-bread.vue'</span>
<span class="token comment">// import XtxBreadItem from './xtx-bread-item.vue'</span>

<span class="token comment">// 导入library文件夹下的所有组件</span>
<span class="token comment">// 批量导入需要使用一个函数 require.context(dir,deep,matching)</span>
<span class="token comment">// 参数：1. 目录  2. 是否加载子目录  3. 加载的正则匹配</span>
<span class="token keyword">const</span> importFn <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.vue$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
<span class="token comment">// console.dir(importFn.keys()) 文件名称数组</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">install</span> <span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// app.component(XtxSkeleton.name, XtxSkeleton)</span>
    <span class="token comment">// app.component(XtxCarousel.name, XtxCarousel)</span>
    <span class="token comment">// app.component(XtxMore.name, XtxMore)</span>
    <span class="token comment">// app.component(XtxBread.name, XtxBread)</span>
    <span class="token comment">// app.component(XtxBreadItem.name, XtxBreadItem)</span>

    <span class="token comment">// 批量注册全局组件</span>
    importFn<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 导入组件</span>
      <span class="token keyword">const</span> component <span class="token operator">=</span> <span class="token function">importFn</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>default
      <span class="token comment">// 注册组件</span>
      app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>component<span class="token punctuation">.</span>name<span class="token punctuation">,</span> component<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 定义指令</span>
    <span class="token function">defineDirective</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">defineDirective</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 图片懒加载指令 v-lazyload</span>
  app<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">'lazyload'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// vue2.0 inserted函数，元素渲染后</span>
    <span class="token comment">// vue3.0 mounted函数，元素渲染后</span>
    <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> binding</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 元素插入后才能获取到dom元素，才能使用 intersectionobserve进行监听进入可视区</span>
      <span class="token comment">// el 是图片元素  binding.value 图片地址</span>
      <span class="token keyword">const</span> observe <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span><span class="token punctuation">{</span> isIntersecting <span class="token punctuation">}</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          el<span class="token punctuation">.</span>src <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
          <span class="token comment">// 取消观察</span>
          observe<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        threshold<span class="token operator">:</span> <span class="token number">0.01</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// 进行观察</span>
      observe<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>总结，知识点：</p> <ul><li>require.context() 是webpack提供的一个自动导入的API
<ul><li>参数1：加载的文件目录</li> <li>参数2：是否加载子目录</li> <li>参数3：正则，匹配文件</li> <li>返回值：导入函数 fn
<ul><li>keys() 获取读取到的所有文件列表</li></ul></li></ul></li></ul> <h2 id="_04-顶级类目-基础布局搭建"><a href="#_04-顶级类目-基础布局搭建" class="header-anchor">#</a> 04-顶级类目-基础布局搭建</h2> <blockquote><p><strong>目的：</strong> 完成顶级分类的，面包屑+轮播图+所属全部子级分类展示。</p></blockquote> <p>大致步骤：</p> <ul><li>准备基础结构，获取轮播图数据给组件使用</li> <li>获取面包屑和所有分类数据给子级分类展示使用</li></ul> <p>落的代码：</p> <ul><li>基本结构和轮播图渲染  <code>src/views/category/index.vue</code></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top-category<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 面包屑 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>空调<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 轮播图 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxCarousel</span> <span class="token attr-name">:sliders</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sliders<span class="token punctuation">&quot;</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token style language-css"><span class="token property">height</span><span class="token punctuation">:</span>500px</span><span class="token punctuation">&quot;</span></span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token comment">&lt;!-- 所有二级分类 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sub-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>全部分类<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i in 8<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://zhoushugang.gitee.io/erabbit-client-pc-static/uploads/img/category%20(9).png<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>空调<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 不同分类商品 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> findBanner <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/home'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'TopCategory'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 轮播图</span>
    <span class="token keyword">const</span> sliders <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token function">findBanner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      sliders<span class="token punctuation">.</span>value <span class="token operator">=</span> data<span class="token punctuation">.</span>result
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> sliders <span class="token punctuation">}</span>  
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.top-category</span> <span class="token punctuation">{</span>
  <span class="token selector">h3</span> <span class="token punctuation">{</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 28px<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
    <span class="token property">font-weight</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.sub-list</span> <span class="token punctuation">{</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token selector">;
    ul</span> <span class="token punctuation">{</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 0 32px<span class="token punctuation">;</span>
      <span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token selector">;
      li</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 168px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 160px<span class="token selector">;
        a</span> <span class="token punctuation">{</span>
          <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
          <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
          <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token selector">;
          img</span> <span class="token punctuation">{</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
            <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token selector">p</span> <span class="token punctuation">{</span>
            <span class="token property">line-height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token selector">&amp;:hover</span> <span class="token punctuation">{</span>
            <span class="token property">color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>从vuex获取分类数据，进行渲染。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">// 面包屑+所有分类</span>
    <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> topCategory <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> cate <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token keyword">const</span> item <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>category<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> item<span class="token punctuation">.</span>id <span class="token operator">===</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">)</span> cate <span class="token operator">=</span> item
      <span class="token keyword">return</span> cate
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      sliders<span class="token punctuation">,</span>
      topCategory<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>top-category<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 面包屑 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>{{topCategory.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 轮播图 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxCarousel</span> <span class="token attr-name">:sliders</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sliders<span class="token punctuation">&quot;</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token style language-css"><span class="token property">height</span><span class="token punctuation">:</span>500px</span><span class="token punctuation">&quot;</span></span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token comment">&lt;!-- 所有二级分类 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sub-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>全部分类<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in topCategory.children<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.picture<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 不同分类商品 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_05-顶级类目-分类商品-布局"><a href="#_05-顶级类目-分类商品-布局" class="header-anchor">#</a> 05-顶级类目-分类商品-布局</h2> <blockquote><p><strong>目的：</strong> 展示各个子级分类下推荐的商品基础布局</p></blockquote> <p>大致步骤：</p> <ul><li>准备单个商品组件</li> <li>完成推荐商品区块布局</li></ul> <p>落的代码：</p> <ul><li>商品信息组件  <code>src/views/category/components/goods-item.vue</code></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RouterLink</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>goods-item<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://zhoushugang.gitee.io/erabbit-client-pc-static/uploads/fresh_goods_2.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name ellipsis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>红功夫 麻辣小龙虾 19.99/500g 实惠到家<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>desc ellipsis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>火锅食材<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>price<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;yen;">&amp;yen;</span>19.99<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RouterLink</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'GoodsItem'</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.goods-item</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 220px<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 20px 30px<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  .<span class="token function">hoverShadow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token selector">;
  img</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 160px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 160px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">p</span> <span class="token punctuation">{</span>
    <span class="token property">padding-top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.name</span> <span class="token punctuation">{</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.desc</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 29px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.price</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@priceColor</span><span class="token punctuation">;</span></span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>顶级分类组件，进行布局 <code>src/views/category/index.vue</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import GoodsItem from './components/goods-item'
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'TopCategory',
</span><span class="token prefix unchanged"> </span><span class="token line"> components: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    GoodsItem
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span></code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code>      <span class="token comment">&lt;!-- 分类关联商品 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ref-goods<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>head<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>- 海鲜 -<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tag<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>温暖柔软，品质之选<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxMore</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>GoodsItem</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i in 5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-less extra-class"><pre class="language-less"><code>  <span class="token selector">.ref-goods</span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token selector">.head</span> <span class="token punctuation">{</span>
      <span class="token selector">.xtx-more</span> <span class="token punctuation">{</span>
        <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
        <span class="token property">top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">right</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.tag</span> <span class="token punctuation">{</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token property">top</span><span class="token punctuation">:</span> <span class="token operator">-</span>20px<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.body</span> <span class="token punctuation">{</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">justify-content</span><span class="token punctuation">:</span> flex<span class="token operator">-</span>start<span class="token punctuation">;</span>
      <span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 0 65px 30px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h2 id="_06-顶级类目-分类商品-展示"><a href="#_06-顶级类目-分类商品-展示" class="header-anchor">#</a> 06-顶级类目-分类商品-展示</h2> <blockquote><p>根据切换路由的时候，根据分类ID获取数据，渲染分类商品。</p></blockquote> <p>大致步骤：</p> <ul><li>定义API，组件初始化要去加载数据，但是动态路由不会重新初始化组件。</li> <li>如果监听地址栏id的变化，然后变化了就去加载数据，但是初始化有不会加载了。</li> <li>不过watch提供了   immediate: true  可让watch初始化的时候主动触发一次。</li></ul> <p>落的代码：</p> <ol><li>定义API  <code>src/api/category.js</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 获取单个顶级分类信息
 * @param {String} id - 顶级分类ID
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">findTopCategory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'/category'</span><span class="token punctuation">,</span> <span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>使用watch加载数据  <code>src/views/category/index.vue</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">// 推荐商品</span>
    <span class="token keyword">const</span> subList <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">getSubList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">findTopCategory</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        subList<span class="token punctuation">.</span>value <span class="token operator">=</span> data<span class="token punctuation">.</span>result<span class="token punctuation">.</span>children
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      newVal <span class="token operator">&amp;&amp;</span> <span class="token function">getSubList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> immediate<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      sliders<span class="token punctuation">,</span>
      topCategory<span class="token punctuation">,</span>
      subList
    <span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>开始渲染 <code>src/views/category/index.vue</code></li></ol> <div class="language-vue extra-class"><pre class="language-vue"><code>      <span class="token comment">&lt;!-- 分类关联商品 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ref-goods<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in subList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>head<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span>- {{item.name}} -<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tag<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{item.desc}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxMore</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>GoodsItem</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>g in item.goods<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>g.id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:goods</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>g<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="4"><li>开始渲染 <code>src/views/category/components/goods-item.vue</code></li></ol> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RouterLink</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>category-goods<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>goods.picture<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name ellipsis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{goods.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>desc ellipsis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{goods.tag}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>price<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token entity named-entity" title="&amp;yen;">&amp;yen;</span>{{goods.price}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RouterLink</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'CategoryGoods'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    goods<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Object<span class="token punctuation">,</span>
      <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>    
</code></pre></div><h2 id="_07-顶级类目-面包屑切换动画"><a href="#_07-顶级类目-面包屑切换动画" class="header-anchor">#</a> 07-顶级类目-面包屑切换动画</h2> <blockquote><p><strong>目的：</strong>   由于切换顶级类目，面包屑文字瞬间完成，体验差，给切换的文字加上动画。</p></blockquote> <p>大致步骤：</p> <ul><li>给面包屑ITEM组件加上Transition组件并且创建 动画条件</li> <li>定义动画css样式</li></ul> <p>落地代码：</p> <ul><li>加transition和name属性，以及加上key属性关联ID才会创建和移除。</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fade-right<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>out-in<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>currCategory.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{currCategory.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>写动画样式 <code>common.less</code>  做为公用</li></ul> <div class="language-less extra-class"><pre class="language-less"><code><span class="token selector">.fade-right-enter-to,
.fade-right-leave-from</span><span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.fade-right-enter-active,
.fade-right-leave-active</span><span class="token punctuation">{</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> all .5s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.fade-right-enter-from,
.fade-right-leave-to</span><span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>20px<span class="token punctuation">,</span>0<span class="token punctuation">,</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>**总结： **   不同的key可以创建移除元素，创造触发动画条件。</p> <h2 id="_08-二级类目-处理跳转细节"><a href="#_08-二级类目-处理跳转细节" class="header-anchor">#</a> 08-二级类目-处理跳转细节</h2> <blockquote><p><strong>目的：</strong>  在路由跳转的时候，优化跳转的细节。</p></blockquote> <p>大致需求：</p> <ul><li>现在的路由跳转默认在当前浏览的位置（卷曲的高度），我们需要会到顶部。</li> <li>在点击二级类目的时候，页面滚动到顶部，造成进入一级类名事件触发，显示其对应二级弹窗，需要处理。</li> <li>切换到二级类目路由的时候也有ID，但是也触发了watch导致发送了请求，需要处理。</li></ul> <p>落的代码：</p> <ul><li>每次切换路由的时候滚动到顶部 <code>src/router/index.js</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code>const router = createRouter({
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> history: createWebHashHistory(),
</span><span class="token prefix unchanged"> </span><span class="token line"> routes,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  scrollBehavior () {
</span><span class="token prefix inserted">+</span><span class="token line">    return { left: 0, top: 0 }
</span><span class="token prefix inserted">+</span><span class="token line">  }
</span></span>})
</code></pre></div><ul><li>滚动到顶部，鼠标有时候会进入一级类目上，触发弹出二级类目。改成在一级类目上移动弹出二级类目。<code>src/components/app-header-nav.vue</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;li class=&quot;home&quot;&gt;&lt;RouterLink to=&quot;/&quot;&gt;首页&lt;/RouterLink&gt;&lt;/li&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;li @mousemove=&quot;show(item)&quot;
</span></span></code></pre></div><ul><li>切换到二级类目路由的时候也有ID，但是也触发了watch导致发送了请求，需要处理。 <code>src/views/category/index.vue</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   watch(() =&gt; route.params.id, (newVal) =&gt; {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      newVal &amp;&amp; getSubList()
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      if (newVal &amp;&amp; `/category/${newVal}` === route.path) getSubList()
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }, { immediate: true })
</span></span></code></pre></div><p><strong>总结：</strong>   跳转的时候需要注意些细节</p> <h2 id="_09-二级类目-展示面包屑"><a href="#_09-二级类目-展示面包屑" class="header-anchor">#</a> 09-二级类目-展示面包屑</h2> <blockquote><p>目的：根据二级类目ID展示多级面包屑</p></blockquote> <p>大致思路：</p> <ul><li><p>封装一个独立的组件来完成，因为需要加动画。</p></li> <li><p>使用组合API的方式通过计算属性得到所需数据</p></li></ul> <p>逻辑代码：</p> <ul><li>从vuex中通过计算属性得到面包屑所需数据 <code>src/views/category/sub-bread.vue</code></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>首页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category.top<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>`/category/${category.top.id}`<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{category.top.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Transition</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fade-right<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>out-in<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxBreadItem</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category.sub<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>category.sub.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{category.sub.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBreadItem</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Transition</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxBread</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> useStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'SubBread'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 注意：setup中this不是当前vue实例</span>

    <span class="token comment">// 1. 获取二级分类的ID，在地址在路由中</span>
    <span class="token comment">// route ===&gt; this.$route</span>
    <span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token comment">// 2. 获取vuex中的类目数据</span>
    <span class="token comment">// store ===&gt; this.$store</span>
    <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
    <span class="token comment">// 3. 通过计算属性得到，二级类目的名称和ID，一级类目的名称和ID</span>
    <span class="token keyword">const</span> category <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>category<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">top</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        top<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> top<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">sub</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>sub<span class="token punctuation">.</span>id <span class="token operator">===</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 设置二级类目</span>
            obj<span class="token punctuation">.</span>sub <span class="token operator">=</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> sub<span class="token punctuation">.</span>id<span class="token punctuation">,</span> name<span class="token operator">:</span> sub<span class="token punctuation">.</span>name <span class="token punctuation">}</span>
            <span class="token comment">// 设置一级类目</span>
            obj<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> top<span class="token punctuation">.</span>id<span class="token punctuation">,</span> name<span class="token operator">:</span> top<span class="token punctuation">.</span>name <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> obj
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 模版需要使用的东西需要setup返回</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> category <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>将该组件在 <code>src/views/category/sub-bread.vue</code>  中使用</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>sub-category<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 面包屑 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SubBread</span> <span class="token punctuation">/&gt;</span></span>
      
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> SubBread <span class="token keyword">from</span> <span class="token string">'./components/sub-bread'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'SubCategory'</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> SubBread<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_10-二级类目-筛选区展示"><a href="#_10-二级类目-筛选区展示" class="header-anchor">#</a> 10-二级类目-筛选区展示</h2> <blockquote><p>目的：根据后台返回的筛选条件展示筛选区域。</p></blockquote> <p>大致步骤：</p> <ul><li>定义一个组件来展示筛选区域</li> <li>获取数据进行品牌和属性的渲染</li></ul> <p>落地代码：</p> <ul><li>基础布局：<code>src/views/category/sub-filter.vue</code></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- 筛选区 --&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sub-filter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i in 4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>head<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>品牌：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>全部<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i in 4<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>小米<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'SubFilter'</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">// 筛选区
  .sub-filter</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 25px<span class="token selector">;
    .item</span> <span class="token punctuation">{</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">line-height</span><span class="token punctuation">:</span> 40px<span class="token selector">;
      .head</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.body</span> <span class="token punctuation">{</span>
        <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token selector">;
        a</span> <span class="token punctuation">{</span>
          <span class="token property">margin-right</span><span class="token punctuation">:</span> 36px<span class="token punctuation">;</span>
          <span class="token property">transition</span><span class="token punctuation">:</span> all .3s<span class="token punctuation">;</span>
          <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token selector">;  
          &amp;.active,
          &amp;:hover</span> <span class="token punctuation">{</span>
            <span class="token property">color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>在 <code>sub</code> 组件使用</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class='sub-category'&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;!-- 面包屑 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;SubBread /&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;!-- 筛选区 --&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;SubFilter /&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>import SubBread from './components/sub-bread'
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import SubFilter from './components/sub-filter'
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'SubCategory',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  components: { SubBread, SubFilter}
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><ul><li>获取数据：在地址栏二级类目ID改变的时候去加载筛选条件数据</li></ul> <p><code>src/api/category.js</code>  定义API</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 获取二级分类筛选条件数据
 * @param {String} id - 二级分类ID
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">findSubCategoryFilter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'/category/sub/filter'</span><span class="token punctuation">,</span> <span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>src/views/category/sub-filter.vue</code>  获取数据，组装数据。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> findSubCategoryFilter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/category'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'SubFilter'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 获取数据</span>
    <span class="token comment">// 2. 数据中需要全部选中，需要预览将来点击激活功能。默认选中全部</span>
    <span class="token comment">// 3. 完成渲染</span>
    <span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> filterData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> filterLoading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token comment">// 4. 分类发生变化的时候需要重新获取筛选数据，需要使用侦听器</span>
    <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 当你从二级分类去顶级分类也会拿到ID，不能去加载数据因为它不是二级分类的ID</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token punctuation">(</span><span class="token string">'/category/sub/'</span> <span class="token operator">+</span> newVal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        filterLoading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
        newVal <span class="token operator">&amp;&amp;</span> <span class="token function">findSubCategoryFilter</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> result <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 品牌全部</span>
          result<span class="token punctuation">.</span>selectedBrand <span class="token operator">=</span> <span class="token keyword">null</span>
          result<span class="token punctuation">.</span>brands<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'全部'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token comment">// 销售属性全部</span>
          result<span class="token punctuation">.</span>saleProperties<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            p<span class="token punctuation">.</span>selectedProp <span class="token operator">=</span> <span class="token keyword">undefined</span>
            p<span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'全部'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          filterData<span class="token punctuation">.</span>value <span class="token operator">=</span> result
          filterLoading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> immediate<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> filterData<span class="token punctuation">,</span> filterLoading <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>渲染模板：<code>src/views/category/sub.vue</code>  且加上骨架效果</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sub-filter<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>filterData &amp;&amp; !filterLoading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>head<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>品牌：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{active:filterData.selectedBrand===brand.id}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javasript:;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>brand in filterData.brands<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>brand.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{brand.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>p in filterData.saleProperties<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>p.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>head<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{p.name}}：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{active:p.selectedProp===attr.id}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javasript:;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>attr in p.properties<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>attr.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{attr.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sub-filter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxSkeleton</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>800px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40px<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxSkeleton</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>800px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40px<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxSkeleton</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>600px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40px<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxSkeleton</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>600px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40px<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxSkeleton</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>600px<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40px<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-less extra-class"><pre class="language-less"><code>    <span class="token selector">.xtx-skeleton</span> <span class="token punctuation">{</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 10px 0<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="_11-二级类目-复选框组件封装"><a href="#_11-二级类目-复选框组件封装" class="header-anchor">#</a> 11-二级类目-复选框组件封装</h2> <blockquote><p>目的：实现一个自定义复选框组件。</p></blockquote> <p>大致步骤：</p> <ul><li>实现组件本身的选中与不选中效果</li> <li>实现组件的v-model指令</li> <li>改造成 <code>@vueuse/core</code> 的函数写法</li></ul> <p>落地代码：</p> <ul><li>1）实现组件功能</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xtx-checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeChecked()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checked<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iconfont icon-checked<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iconfont icon-unchecked<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$slots.default<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'XtxCheckbox'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> checked <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">changeChecked</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      checked<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token operator">!</span>checked<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> checked<span class="token punctuation">,</span> changeChecked <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.xtx-checkbox</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
  <span class="token property">margin-right</span><span class="token punctuation">:</span> 2px<span class="token selector">;
  .icon-checked</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
    <span class="token selector">~ span</span> <span class="token punctuation">{</span>
      <span class="token property">color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">i</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 1px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">span</span> <span class="token punctuation">{</span>
    <span class="token property">margin-left</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>2）实现双向绑定
<ul><li>vue3.0中v-model会拆解成  属性 <code>modelValue</code>   和  事件 <code>update:modelValue</code></li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token comment">// v-model  ====&gt;  :modelValue  +   @update:modelValue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'XtxCheckbox'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    modelValue<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> checked <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">changeChecked</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      checked<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token operator">!</span>checked<span class="token punctuation">.</span>value
      <span class="token comment">// 使用emit通知父组件数据的改变</span>
      <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'update:modelValue'</span><span class="token punctuation">,</span> checked<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 使用侦听器，得到父组件传递数据，给checked数据</span>
    <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>modelValue<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      checked<span class="token punctuation">.</span>value <span class="token operator">=</span> props<span class="token punctuation">.</span>modelValue
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> immediate<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> checked<span class="token punctuation">,</span> changeChecked <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>3）补充 <code>@vueuse/core</code> 的实现</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useVModel <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vueuse/core'</span>
<span class="token comment">// v-model  ====&gt;  :modelValue  +   @update:modelValue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'XtxCheckbox'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    modelValue<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用useVModel实现双向数据绑定v-model指令</span>
    <span class="token comment">// 1. 使用props接收modelValue</span>
    <span class="token comment">// 2. 使用useVModel来包装props中的modelValue属性数据</span>
    <span class="token comment">// 3. 在使用checked.value就是使用父组件数据</span>
    <span class="token comment">// 4. 在使用checked.value = '数据' 赋值，触发emit('update:modelvalue', '数据')</span>
    <span class="token keyword">const</span> checked <span class="token operator">=</span> <span class="token function">useVModel</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> <span class="token string">'modelValue'</span><span class="token punctuation">,</span> emit<span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">changeChecked</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> newVal <span class="token operator">=</span> <span class="token operator">!</span>checked<span class="token punctuation">.</span>value
      <span class="token comment">// 通知父组件</span>
      checked<span class="token punctuation">.</span>value <span class="token operator">=</span> newVal
      <span class="token comment">// 让组件支持change事件</span>
      <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> checked<span class="token punctuation">,</span> changeChecked <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>总结： <code>useVModel</code> 工具函数可实现双向绑定。</p> <h2 id="_12-二级类目-结果区-排序组件"><a href="#_12-二级类目-结果区-排序组件" class="header-anchor">#</a> 12-二级类目-结果区-排序组件</h2> <blockquote><p>目的：封装排序组件，完成排序切换效果</p></blockquote> <p>大致步骤：</p> <ul><li>定义一个组件 <code>sub-sort</code>，完成基础布局</li> <li>在 <code>sub.vue</code> 组件使用</li> <li>完成切换排序时候的交换效果</li></ul> <p>落地代码：</p> <ul><li>1）基础布局： <code>src/views/category/components/sub-sort.vue</code></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>sub-sort<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sort<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>默认排序<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>最新商品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>最高人气<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>评论最多<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        价格排序
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>arrow up<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>arrow down<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>check<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxCheckbox</span><span class="token punctuation">&gt;</span></span>仅显示有货商品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxCheckbox</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxCheckbox</span><span class="token punctuation">&gt;</span></span>仅显示特惠商品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxCheckbox</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'SubSort'</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.sub-sort</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token selector">;
  .sort</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token selector">;
    a</span> <span class="token punctuation">{</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
      <span class="token property">line-height</span><span class="token punctuation">:</span> 28px<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #e4e4e4<span class="token punctuation">;</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 0 20px<span class="token punctuation">;</span>
      <span class="token property">margin-right</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span>
      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
      <span class="token property">transition</span><span class="token punctuation">:</span> all .3s<span class="token selector">;
      &amp;.active</span> <span class="token punctuation">{</span>
        <span class="token property">background</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
        <span class="token property">border-color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
        <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.arrow</span> <span class="token punctuation">{</span>
        <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 5px solid transparent<span class="token punctuation">;</span>
        <span class="token property">right</span><span class="token punctuation">:</span> 8px<span class="token selector">;
        &amp;.up</span> <span class="token punctuation">{</span>
          <span class="token property">top</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
          <span class="token property">border-bottom-color</span><span class="token punctuation">:</span> #bbb<span class="token selector">;
            &amp;.active</span> <span class="token punctuation">{</span>
            <span class="token property">border-bottom-color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token selector">&amp;.down</span> <span class="token punctuation">{</span>
          <span class="token property">top</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
          <span class="token property">border-top-color</span><span class="token punctuation">:</span> #bbb<span class="token selector">;
          &amp;.active</span> <span class="token punctuation">{</span>
            <span class="token property">border-top-color</span><span class="token punctuation">:</span> <span class="token atrule"><span class="token rule">@xtxColor</span><span class="token punctuation">;</span></span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.check</span> <span class="token punctuation">{</span>
    <span class="token selector">.xtx-checkbox</span> <span class="token punctuation">{</span>
      <span class="token property">margin-left</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>使用组件：<code>src/views/category/sub.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class='sub-category'&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;!-- 面包屑 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;SubBread /&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;!-- 筛选区 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;SubFilter /&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;!-- 结果区域 --&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;div class=&quot;goods-list&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;!-- 排序 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;SubSort /&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;!-- 列表 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>import SubBread from './components/sub-bread'
import SubFilter from './components/sub-filter'
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import SubSort from './components/sub-sort'
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'SubCategory',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  components: { SubBread, SubFilter, SubSort}
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style scoped lang='less'&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">.goods-list {
</span><span class="token prefix inserted">+</span><span class="token line">  background: #fff;
</span><span class="token prefix inserted">+</span><span class="token line">  padding: 0 25px;
</span><span class="token prefix inserted">+</span><span class="token line">  margin-top: 25px;
</span><span class="token prefix inserted">+</span><span class="token line">}
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span>
</code></pre></div><ul><li>2）交互效果：</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>sub-sort<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sort<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{active:sortParams.sortField===null}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeSort(null)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>默认排序<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{active:sortParams.sortField===<span class="token punctuation">'</span>publishTime<span class="token punctuation">'</span>}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeSort(<span class="token punctuation">'</span>publishTime<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>最新商品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{active:sortParams.sortField===<span class="token punctuation">'</span>orderNum<span class="token punctuation">'</span>}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeSort(<span class="token punctuation">'</span>orderNum<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>最高人气<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{active:sortParams.sortField===<span class="token punctuation">'</span>evaluateNum<span class="token punctuation">'</span>}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeSort(<span class="token punctuation">'</span>evaluateNum<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>评论最多<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeSort(<span class="token punctuation">'</span>price<span class="token punctuation">'</span>)<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:;<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        价格排序
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>arrow up<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{active:sortParams.sortField===<span class="token punctuation">'</span>price<span class="token punctuation">'</span>&amp;&amp;sortParams.sortMethod==<span class="token punctuation">'</span>asc<span class="token punctuation">'</span>}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>arrow down<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{active:sortParams.sortField===<span class="token punctuation">'</span>price<span class="token punctuation">'</span>&amp;&amp;sortParams.sortMethod==<span class="token punctuation">'</span>desc<span class="token punctuation">'</span>}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>check<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxCheckbox</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sortParams.inventory<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>仅显示有货商品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxCheckbox</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxCheckbox</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sortParams.onlyDiscount<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>仅显示特惠商品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxCheckbox</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'SubSort'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 根据后台需要的参数定义数据对象</span>
    <span class="token comment">// 2. 根据数据对象，绑定组件（复选框，排序按钮）</span>
    <span class="token comment">// 3. 在操作排序组件的时候，需要反馈给数据对象</span>
    <span class="token comment">// sortField====&gt;publishTime,orderNum,price,evaluateNum</span>
    <span class="token comment">// sortMethod====&gt;asc为正序 desc为倒序</span>
    <span class="token keyword">const</span> sortParams <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      inventory<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      onlyDiscount<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      sortField<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      sortMethod<span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 改变排序</span>
    <span class="token keyword">const</span> <span class="token function-variable function">changeSort</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sortField</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>sortField <span class="token operator">===</span> <span class="token string">'price'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sortParams<span class="token punctuation">.</span>sortField <span class="token operator">=</span> sortField
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sortParams<span class="token punctuation">.</span>sortMethod <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 第一次点击，默认是降序</span>
          sortParams<span class="token punctuation">.</span>sortMethod <span class="token operator">=</span> <span class="token string">'desc'</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 其他情况根据当前排序取反</span>
          sortParams<span class="token punctuation">.</span>sortMethod <span class="token operator">=</span> sortParams<span class="token punctuation">.</span>sortMethod <span class="token operator">===</span> <span class="token string">'desc'</span> <span class="token operator">?</span> <span class="token string">'asc'</span> <span class="token operator">:</span> <span class="token string">'desc'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果排序未改变停止逻辑  </span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sortParams<span class="token punctuation">.</span>sortField <span class="token operator">===</span> sortField<span class="token punctuation">)</span>  <span class="token keyword">return</span>
        sortParams<span class="token punctuation">.</span>sortField <span class="token operator">=</span> sortField
        sortParams<span class="token punctuation">.</span>sortMethod <span class="token operator">=</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> sortParams<span class="token punctuation">,</span> changeSort <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_13-二级类目-结果区-数据加载"><a href="#_13-二级类目-结果区-数据加载" class="header-anchor">#</a> 13-二级类目-结果区-数据加载</h2> <blockquote><p>目的：实现结果区域商品展示。</p></blockquote> <p>大致步骤：</p> <ul><li>完成结果区域商品布局</li> <li>完成 <code>xtx-infinite-loading</code> 组件封装</li> <li>使用 <code>xtx-infinite-loading</code> 完成数据加载和渲染</li></ul> <p>落地代码：<code>src/views/category/sub.vue</code></p> <ol><li>基础布局</li></ol> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>sub-category<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- 面包屑 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SubBread</span> <span class="token punctuation">/&gt;</span></span>
      <span class="token comment">&lt;!-- 筛选区 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SubFilter</span> <span class="token punctuation">/&gt;</span></span>
      <span class="token comment">&lt;!-- 结果区域 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>goods-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 排序 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SubSort</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- 列表 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i in 20<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>GoodsItem</span> <span class="token attr-name">:goods</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> SubBread <span class="token keyword">from</span> <span class="token string">'./components/sub-bread'</span>
<span class="token keyword">import</span> SubFilter <span class="token keyword">from</span> <span class="token string">'./components/sub-filter'</span>
<span class="token keyword">import</span> SubSort <span class="token keyword">from</span> <span class="token string">'./components/sub-sort'</span>
<span class="token keyword">import</span> GoodsItem <span class="token keyword">from</span> <span class="token string">'./components/goods-item'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'SubCategory'</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> SubBread<span class="token punctuation">,</span> SubFilter<span class="token punctuation">,</span> SubSort<span class="token punctuation">,</span> GoodsItem <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.goods-list</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 25px<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 25px<span class="token selector">;
  ul</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">flex-wrap</span><span class="token punctuation">:</span> wrap<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0 5px<span class="token selector">;
    li</span> <span class="token punctuation">{</span>
      <span class="token property">margin-right</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 20px<span class="token selector">;
      &amp;:nth-child(5n)</span> <span class="token punctuation">{</span>
        <span class="token property">margin-right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li>无限列表加载组件 <code>src/components/xtx-infinite-loading.vue</code></li></ol> <p><img src="/erabbit-client-pc-document/assets/img/1616743745379.53c10663.png" alt="1616743745379"></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xtx-infinite-loading<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>正在加载...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>none<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>finished<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>亲，没有更多了<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useIntersectionObserver <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vueuse/core'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'XtxInfiniteLoading'</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    loading<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    finished<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
    <span class="token function">useIntersectionObserver</span><span class="token punctuation">(</span>
      container<span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span><span class="token punctuation">{</span> isIntersecting <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dom</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>loading <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">&amp;&amp;</span> props<span class="token punctuation">.</span>finished <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'infinite'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        threshold<span class="token operator">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> container <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>less<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.xtx-infinite-loading</span> <span class="token punctuation">{</span>
  <span class="token selector">.loading</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token selector">;
    .img</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../../assets/images/load.gif<span class="token punctuation">)</span></span> no-repeat center / contain<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.text</span> <span class="token punctuation">{</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.none</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token selector">;
    .img</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 134px<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span>../../assets/images/none.png<span class="token punctuation">)</span></span> no-repeat center / contain<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.text</span> <span class="token punctuation">{</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #999<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><ol start="3"><li>定义获取数据的API <code>src/api/category.js</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">/**
 * 获取分类下的商品（带筛选条件）
 * @param {Object} params - 可参考接口文档
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">findSubCategoryGoods</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token string">'/category/goods/temporary'</span><span class="token punctuation">,</span> <span class="token string">'post'</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


</code></pre></div><ol start="4"><li>在<code>src/views/category/sub.vue</code> 使用组件</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;!-- 结果区域 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;goods-list&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 排序 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;GoodsSort /&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 列表 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;li v-for=&quot;item in list&quot; :key=&quot;item.id&quot; &gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;GoodsItem :goods=&quot;item&quot; /&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 加载 --&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;XtxInfiniteLoading :loading=&quot;loading&quot; :finished=&quot;finished&quot; @infinite=&quot;getData&quot; /&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span></span></code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> SubBread <span class="token keyword">from</span> <span class="token string">'./components/sub-bread'</span>
<span class="token keyword">import</span> SubFilter <span class="token keyword">from</span> <span class="token string">'./components/sub-filter'</span>
<span class="token keyword">import</span> SubSort <span class="token keyword">from</span> <span class="token string">'./components/sub-sort'</span>
<span class="token keyword">import</span> GoodsItem <span class="token keyword">from</span> <span class="token string">'./components/goods-item'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> findSubCategoryGoods <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/category'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'SubCategory'</span><span class="token punctuation">,</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> SubBread<span class="token punctuation">,</span> SubFilter<span class="token punctuation">,</span> SubSort<span class="token punctuation">,</span> GoodsItem <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 基础布局</span>
    <span class="token comment">// 2. 无限加载组件</span>
    <span class="token comment">// 3. 动态加载数据且渲染</span>
    <span class="token comment">// 4. 任何筛选条件变化需要更新列表</span>
    <span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> finished <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> goodsList <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">// 查询参数</span>
    <span class="token keyword">let</span> reqParams <span class="token operator">=</span> <span class="token punctuation">{</span>
      page<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      pageSize<span class="token operator">:</span> <span class="token number">20</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 获取数据函数</span>
    <span class="token keyword">const</span> <span class="token function-variable function">getData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
      reqParams<span class="token punctuation">.</span>categoryId <span class="token operator">=</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id
      <span class="token function">findSubCategoryGoods</span><span class="token punctuation">(</span>reqParams<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> result <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>items<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          goodsList<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>result<span class="token punctuation">.</span>items<span class="token punctuation">)</span>
          reqParams<span class="token punctuation">.</span>page<span class="token operator">++</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 加载完毕</span>
          finished<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 请求结束</span>
        loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 切换二级分类重新加载</span>
    <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token punctuation">(</span><span class="token string">'/category/sub/'</span> <span class="token operator">+</span> newVal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        goodsList<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        reqParams <span class="token operator">=</span> <span class="token punctuation">{</span>
          page<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          pageSize<span class="token operator">:</span> <span class="token number">20</span>
        <span class="token punctuation">}</span>
        finished<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> finished<span class="token punctuation">,</span> goodsList<span class="token punctuation">,</span> getData <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_14-二级类目-结果区-进行筛选"><a href="#_14-二级类目-结果区-进行筛选" class="header-anchor">#</a> 14-二级类目-结果区-进行筛选</h2> <blockquote><p>目的：在做了筛选和排序的时候从新渲染商品列表。</p></blockquote> <p>大致步骤：</p> <ul><li>排序组件，当你点击了排序后 或者 复选框改变后  触发自定义事件 <code>sort-change</code>  传出排序参数</li> <li>筛选组件，当你改了品牌，或者其他筛选添加，触发自定义事件 <code>filter-change</code>  传出筛选参数</li> <li>在sub组件，分别绑定 <code>sort-change</code> <code>filter-change</code>  得到参数和当前参数合并，回到第一页，清空数据，设置未加载完成，触发加载。</li></ul> <p>落地代码：</p> <ul><li>组件：<code>src/views/category/components/sub-sort.vue</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // 改变排序
</span><span class="token prefix unchanged"> </span><span class="token line">   const changeSort = (sortField) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">     // 省略代码....
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      emit('sort-change', sortParams)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }    
</span></span></code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>check<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxCheckbox</span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeCheck<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sortParams.inventory<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>仅显示有货商品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxCheckbox</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>XtxCheckbox</span> <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeCheck<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sortParams.onlyDiscount<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>仅显示特惠商品<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>XtxCheckbox</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">const</span> <span class="token function-variable function">changeCheck</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sortField</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'sort-change'</span><span class="token punctuation">,</span> sortParams<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><ul><li>组件 <code>src/views/category/components/sub-filter.vue</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">// 获取筛选参数</span>
    <span class="token keyword">const</span> <span class="token function-variable function">getFilterParams</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> filterParams <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
      <span class="token keyword">const</span> attrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      filterParams<span class="token punctuation">.</span>brandId <span class="token operator">=</span> filterData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>selectedBrand
      filterData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>saleProperties<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> attr <span class="token operator">=</span> p<span class="token punctuation">.</span>properties<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">attr</span> <span class="token operator">=&gt;</span> attr<span class="token punctuation">.</span>id <span class="token operator">===</span> p<span class="token punctuation">.</span>selectedProp<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>attr <span class="token operator">&amp;&amp;</span> attr<span class="token punctuation">.</span>id <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          attrs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> groupName<span class="token operator">:</span> p<span class="token punctuation">.</span>name<span class="token punctuation">,</span> propertyName<span class="token operator">:</span> attr<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>attrs<span class="token punctuation">.</span>length<span class="token punctuation">)</span> filterParams<span class="token punctuation">.</span>attrs <span class="token operator">=</span> attrs
      <span class="token keyword">return</span> filterParams
    <span class="token punctuation">}</span>

    <span class="token comment">// 选择品牌</span>
    <span class="token keyword">const</span> <span class="token function-variable function">changeBrand</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">brandId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>filterData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>selectedBrand <span class="token operator">===</span> brandId<span class="token punctuation">)</span> <span class="token keyword">return</span> 
      filterData<span class="token punctuation">.</span>value<span class="token punctuation">.</span>selectedBrand <span class="token operator">=</span> brandId
      <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'filter-change'</span><span class="token punctuation">,</span> <span class="token function">getFilterParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 选中属性</span>
    <span class="token keyword">const</span> <span class="token function-variable function">changeAttr</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> attrId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>selectedProp <span class="token operator">===</span> attrId<span class="token punctuation">)</span> <span class="token keyword">return</span>
      p<span class="token punctuation">.</span>selectedProp <span class="token operator">=</span> attrId
      <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'filter-change'</span><span class="token punctuation">,</span> <span class="token function">getFilterParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> filterData<span class="token punctuation">,</span> filterLoading<span class="token punctuation">,</span> changeBrand<span class="token punctuation">,</span> changeAttr <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><ul><li>组件  <code>src/views/category/sub.vue</code></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SubFilter</span> <span class="token attr-name">@sort-change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeFilter<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>GoodsSort</span> <span class="token attr-name">@filter-change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeSort<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token comment">// 监听筛选区改变</span>
    <span class="token keyword">const</span> <span class="token function-variable function">changeFilter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">filterParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      reqParams <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>reqParams<span class="token punctuation">,</span> <span class="token operator">...</span>filterParams <span class="token punctuation">}</span>
      reqParams<span class="token punctuation">.</span>page <span class="token operator">=</span> <span class="token number">1</span>
      goodsList<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      finished<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 监听排序改变</span>
    <span class="token keyword">const</span> <span class="token function-variable function">changeSort</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">sortParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      reqParams <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>reqParams<span class="token punctuation">,</span> <span class="token operator">...</span>sortParams <span class="token punctuation">}</span>
      reqParams<span class="token punctuation">.</span>page <span class="token operator">=</span> <span class="token number">1</span>
      goodsList<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      finished<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> finished<span class="token punctuation">,</span> goodsList<span class="token punctuation">,</span> getData<span class="token punctuation">,</span> changeFilter<span class="token punctuation">,</span> changeSort <span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/erabbit-client-pc-document/assets/js/app.948bdee4.js" defer></script><script src="/erabbit-client-pc-document/assets/js/2.e30d490f.js" defer></script><script src="/erabbit-client-pc-document/assets/js/14.e446ef51.js" defer></script>
  </body>
</html>
